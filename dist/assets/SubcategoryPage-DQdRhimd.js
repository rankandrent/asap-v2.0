import{c as A,u as k,e as I,j as e,B as p,d as M,r as f}from"./index-BaYg4v0E.js";import{u as F}from"./useCategories-Fs3OXM6r.js";import{C as B,u as R,B as z}from"./Breadcrumb-74ORcTbN.js";import{g as T}from"./queries-CZBLKuiv.js";import{L as V,P as _}from"./LoadingSpinner-Tns4J9jP.js";import{S as N}from"./SEO-uX4JX8lL.js";import"./card-B7NPPkN6.js";import"./badge-C-xAuew-.js";const q=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],D=A("chevron-left",q),O=(a,s,o)=>{const{selectedManufacturer:m}=k();return I({queryKey:["parts",a,s,m,o,"v3"],queryFn:()=>{if(!m)throw new Error("No manufacturer selected");return T(a,s,m,o)},enabled:!!a&&!!s&&!!m,placeholderData:d=>d,staleTime:120*1e3})};function K({currentPage:a,totalPages:s,onPageChange:o}){const m=[];let c=Math.max(1,a-Math.floor(3.5)),t=Math.min(s,c+7-1);t-c<6&&(c=Math.max(1,t-7+1));for(let n=c;n<=t;n++)m.push(n);return s<=1?null:e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-8",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>o(a-1),disabled:a===1,children:[e.jsx(D,{className:"h-4 w-4"}),"Previous"]}),c>1&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>o(1),children:"1"}),c>2&&e.jsx("span",{className:"px-2",children:"..."})]}),m.map(n=>e.jsx(p,{variant:a===n?"default":"outline",size:"sm",onClick:()=>o(n),children:n},n)),t<s&&e.jsxs(e.Fragment,{children:[t<s-1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>o(s),children:s})]}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>o(a+1),disabled:a===s,children:["Next",e.jsx(B,{className:"h-4 w-4"})]})]})}const h=50;function Z(){const{categorySlug:a,subcategorySlug:s}=M(),[o,m]=f.useState(1),{data:d}=F(),{data:c}=R(a||""),{data:t,isLoading:n,error:g,isError:u}=O(a||"",s||"",o);f.useEffect(()=>{m(1)},[a,s]),f.useEffect(()=>{console.log("ðŸ“Š SubcategoryPage: Parts query state:",{categorySlug:a,subcategorySlug:s,page:o,isLoading:n,isError:u,partsError:g?.message,partsData:t,partsCount:t&&"parts"in t?t.parts.length:0,totalParts:t&&"total"in t?t.total:0,totalPages:t&&"total"in t?Math.ceil(t.total/h):0})},[a,s,o,n,u,g,t]);const l=d?.find(i=>i.slug===a),r=c?.find(i=>i.slug===s),S=t&&"total"in t?Math.ceil(t.total/h):0;if((!l||!r)&&d&&c)return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Subcategory Not Found",description:"The subcategory you're looking for doesn't exist.",canonical:`https://asap-amatom.com/categories/${a}/${s}`}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("p",{children:"Subcategory not found."})})]});const v=`${r?.name||"Subcategory"} - ${l?.name||"Category"} | Amatom Parts | ASAP-Amatom.com`,y=t&&"total"in t?t.total:0,b=`Shop ${r?.name||"subcategory"} from Amatom manufacturer. Complete catalog of ${y.toLocaleString()} ${r?.name} parts. Browse specifications, pricing, and availability. Category: ${l?.name}. Official ASAP-Amatom.com.`,$=`${r?.name}, ${l?.name}, Amatom ${r?.name}, ${r?.name} parts, buy ${r?.name}, aerospace ${r?.name}, industrial parts`,x=`https://asap-amatom.com/categories/${a}/${s}`,C=t&&"parts"in t&&t.parts.length>0&&t.parts[0].images&&t.parts[0].images.length>0?t.parts[0].images[0]:`https://asap-amatom.com/images/categories/${a}.jpg`,j={"@context":"https://schema.org","@type":"ItemList",name:`${r?.name} - ${l?.name}`,description:b,numberOfItems:y,url:x,itemListElement:t&&"parts"in t?t.parts.slice(0,10).map((i,E)=>({"@type":"ListItem",position:E+1,item:{"@type":"Product",name:i.productname,description:i.description,url:`https://asap-amatom.com/parts/${encodeURIComponent(i.productname)}`,...i.images&&i.images.length>0&&{image:i.images[0]}}})):[]},P={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Home",item:"https://asap-amatom.com"},{"@type":"ListItem",position:2,name:l?.name||"Category",item:`https://asap-amatom.com/categories/${a}`},{"@type":"ListItem",position:3,name:r?.name||"Subcategory",item:x}]},L={"@context":"https://schema.org","@type":"CollectionPage",name:`${r?.name} - ${l?.name}`,description:b,url:x,mainEntity:j},w={"@context":"https://schema.org","@graph":[j,P,L]};return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:v,description:b,canonical:x,ogType:"website",ogImage:C,keywords:$,schema:w}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(z,{items:[{label:"Categories",href:"/"},{label:l?.name||"Category",href:`/categories/${a}`},{label:r?.name||"Subcategory"}]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:r?.name}),e.jsxs("p",{className:"text-muted-foreground",children:[t&&"total"in t?t.total.toLocaleString():0," parts available"]})]}),u&&g&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error Loading Parts"}),e.jsx("p",{className:"text-red-600 mb-4",children:g.message}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]}),n?e.jsx(V,{size:"lg"}):e.jsx(e.Fragment,{children:t&&"parts"in t&&t.parts.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:t.parts.map(i=>e.jsx(_,{part:i},i.id))}),e.jsxs("div",{className:"mb-4 text-center text-sm text-gray-600",children:["Showing ",(o-1)*h+1," to ",Math.min(o*h,t.total)," of ",t.total.toLocaleString()," parts"]}),e.jsx(K,{currentPage:o,totalPages:S,onPageChange:i=>{m(i),window.scrollTo({top:0,behavior:"smooth"})}})]}):e.jsxs("div",{className:"text-center py-12",children:[!n&&!u&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No parts found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No parts available for this subcategory. Please check:"}),e.jsxs("ul",{className:"text-sm text-gray-600 text-left max-w-md mx-auto",children:[e.jsxs("li",{children:["â€¢ Category: ",l?.name||a]}),e.jsxs("li",{children:["â€¢ Subcategory: ",r?.name||s]}),e.jsx("li",{children:"â€¢ Manufacturer: Amatom"})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Refresh Page"})]}),n&&e.jsx("p",{className:"text-muted-foreground",children:"Loading parts..."})]})})]})]})}export{Z as default};
